<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=1200" />
  <title>Icsd</title>
  <base href="/">
  <script src="https://code.jquery.com/jquery-1.12.4.js"></script>
  <script src="https://code.jquery.com/ui/1.12.1/jquery-ui.js"></script>
  <link rel="stylesheet" href="https://code.jquery.com/ui/1.12.1/themes/base/jquery-ui.css">
  <!-- Firebase App is always required and must be first -->
  <script src="https://www.gstatic.com/firebasejs/5.3.0/firebase-app.js"></script>

  <!-- Add additional services that you want to use -->
  <script src="https://www.gstatic.com/firebasejs/5.3.0/firebase-auth.js"></script>
  <script src="https://www.gstatic.com/firebasejs/5.3.0/firebase-database.js"></script>
  <script src="https://www.gstatic.com/firebasejs/5.3.0/firebase-firestore.js"></script>
  <script src="https://www.gstatic.com/firebasejs/5.3.0/firebase-messaging.js"></script>
  <script src="https://www.gstatic.com/firebasejs/5.3.0/firebase-functions.js"></script>

  <!-- Comment out (or don't include) services that you don't want to use -->
  <!-- <script src="https://www.gstatic.com/firebasejs/5.3.0/firebase-storage.js"></script> -->
  <script src="https://www.gstatic.com/firebasejs/5.3.0/firebase.js"></script>
  <script>
    // Initialize Firebase
    var config = {
      apiKey: "AIzaSyCzCeAL99M7BRKyIbv0-NX0qg-FgeIH0XY",
      authDomain: "icsd-app.firebaseapp.com",
      databaseURL: "https://icsd-app.firebaseio.com",
      projectId: "icsd-app",
      storageBucket: "icsd-app.appspot.com",
      messagingSenderId: "843528895145"
    };
    firebase.initializeApp(config);
  </script>
  <script>
  var KeyowrdsCounter = 3;
    function load() {
      // expand the textarea only at the first time the web starts and hide the button
      document.getElementById('func').cols = 120;
      document.getElementById('func').rows = 20;
     // document.getElementById('convert').style.padding = '12px 17px';

      $('#convert').focus();
      $(window).scrollTop(0);

      // do loader a little more time to let the table to show correctly
      setTimeout(function() { document.getElementById("loader").style.display = "none"; document.getElementById("loader2").style.display = "none"; }, 200);

      if (navigator.userAgent.match(/Android/i) || navigator.userAgent.match(/iPhone|iPad|iPod/i)) {
        alert('This website is not fully support for mobile devices, please use a desktop pc.');
      }
      document.getElementById('savebtn12').addEventListener('click', save_to_database);
      document.getElementById('closebtn12').addEventListener('click', clear_forum);
    }
    function conv(){
      if (document.getElementById('func').value == '') {
        alert('please enter a function');
        return;
      }
      var y = document.getElementsByClassName("liHide");
      for (var i = 0; i < y.length; i++) {
        y[i].style.display = "inline-block";
      }
    document.getElementById('func').cols = 40;
    document.getElementById('func').rows = 29;
    document.getElementById('welcome').style.display='none';
   $(".ui-dialog-content").dialog("close");
}
    var database = firebase.database();
    var keywordsRef = firebase.database().ref('/Keywords');
    keywordsRef.on('value', function (snapshot) {
      snapshot.forEach(function (childSnapshot) {
        var opt = document.createElement('option');
        opt.value = childSnapshot.val();
        opt.text = childSnapshot.val();
        opt.innerHTML = childSnapshot.val();
        document.getElementById('keywords').appendChild(opt);
      });
    });

    function addKeyword() {
      var newvalue = document.getElementById('newkeyword').value;
      if(newvalue == ''){
        return;
      }
      var select = document.getElementById('keywords');
      var counter = select.children.length+1;
      for(var i=0;i<counter-1;i++){
        if(select.children[i].value == newvalue){
          alert('Keyword exists!');
          return;
        }
      }
      select.innerHTML = '';
      document.getElementById('newkeyword').value = '';
      firebase.database().ref('/Keywords/'+counter).set(newvalue);
    }
    function add_keyword_to_list() {
      if(document.getElementById('chosen').value.search(document.getElementById('keywords').value+', ') == -1) {
        document.getElementById('chosen').value += document.getElementById('keywords').value + ', ';
      }
  }
    function save_to_database() {
      var keywords_array = document.getElementById('chosen').value.split(', ');
      keywords_array.pop();
      keywords_str = keywords_array.sort().toString();
      var url = 'https://icsd-app.firebaseio.com/Functions/' + keywords_str + '.' + 'json';
      var my_request = new XMLHttpRequest();
      my_request.open('GET', url);
      push_func_to_database(keywords_str);
    }

    function push_func_to_database(keywords_name) {
      firebase.database().ref('/Functions/'+ keywords_name + '/').push(
        {
            "body": document.getElementById('func').value,
            "name": document.getElementById('funcname').value
        });
      alert('Function saved in our database');
      clear_forum();
    }

    function clear_forum() {
      document.getElementById('funcname').value = '';
      document.getElementById('keywords').value = '';
      document.getElementById('newkeyword').value = '';
      document.getElementById('chosen').value = '';

    }
  </script>
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <link rel="icon" type="image/x-icon" href="favicon.ico">
</head>
<body onload="load()">
<div id="loader2"></div>
<div id="loader"></div>


<app-root></app-root>

</body>
</html>
